{% extends 'designs/base.html' %}
{% block title %}Ø¹Ø±Ø¶ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… - StyleBox{% endblock %}

{% block content %}
<h1 class="page-title">ğŸ¨ ÙƒÙ„ Ø§Ù„ØªØµØ§Ù…ÙŠÙ…</h1>

<!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„Ø§ØªØ± -->
<div class="mb-6 text-center space-x-2 rtl:space-x-reverse">
  <a href="?" class="filter-btn active">Ø§Ù„ÙƒÙ„</a>
  <a href="?type=button" class="filter-btn">Ø£Ø²Ø±Ø§Ø±</a>
  <a href="?type=card" class="filter-btn">ÙƒØ±ÙˆØª</a>
  <a href="?type=navbar" class="filter-btn">Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„</a>
  <a href="?type=header" class="filter-btn">Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø©</a>
  <a href="?type=form" class="filter-btn">Ù†Ù…ÙˆØ°Ø¬</a>
</div>

<!-- Ø¹Ø±Ø¶ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  {% for design in designs %}
    <div class="design-card bg-white shadow rounded-lg p-5 flex flex-col justify-between">
      <div>
        <h2 class="text-xl font-bold text-blue-600 mb-1">{{ design.name }}</h2>
        <p class="text-sm text-gray-500 mb-2">Ø§Ù„Ù†ÙˆØ¹: {{ design.get_design_type_display }}</p>
        <p class="text-gray-700 text-sm mb-3">{{ design.description|default:"Ø¨Ø¯ÙˆÙ† ÙˆØµÙ" }}</p>

        <!-- Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø­ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… iframe -->
        <div class="preview-box">
          <iframe 
            id="preview-iframe-{{ design.id }}" 
            class="w-full h-48 border rounded bg-white"
            onload="
              const iframe = this;
              const doc = iframe.contentWindow.document;
              doc.open();
              doc.write(`<!DOCTYPE html><html><head><style>{{ design.css_code|escapejs }}</style></head><body style='margin:0;padding:1rem;'>{{ design.html_code|escapejs }}</body></html>`);
              doc.close();
            ">
          </iframe>
        </div>

        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® -->
        <div class="flex gap-2 mb-3">
          <button class="btn-copy" onclick="copyToClipboard(`{{ design.html_code|escapejs }}`)">ğŸ“‹ Ù†Ø³Ø® HTML</button>
          <button class="btn-copy" onclick="copyToClipboard(`{{ design.css_code|escapejs }}`)">ğŸ“‹ Ù†Ø³Ø® CSS</button>
        </div>
      </div>
{% if request.user == design.creator %}
  <a href="{% url 'edit_design' design.pk %}" class="btn-primary mt-2 inline-block">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØµÙ…ÙŠÙ…</a>
{% endif %}

      <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµÙ…Ù… -->
      <div class="text-sm text-gray-600 mt-auto">
        ğŸ‘¤ Ø¨ÙˆØ§Ø³Ø·Ø©:
        <a href="{% url 'designer_profile' design.creator.username %}" class="text-blue-500 hover:underline">
          {{ design.creator.username }}
        </a><br>
        ğŸ•’ Ø¨ØªØ§Ø±ÙŠØ®: {{ design.created_at|date:"Y-m-d H:i" }}
      </div>
    </div>
  {% empty %}
    <p class="text-center text-gray-500 col-span-3">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØµØ§Ù…ÙŠÙ… Ø¨Ø¹Ø¯.</p>
  {% endfor %}
  
</div>
{% endblock %}
