{% extends 'designs/base.html' %}
{% block title %}Ø¹Ø±Ø¶ Ø§Ù„ØªØµØ§Ù…ÙŠÙ… - StyleBox{% endblock %}

{% block content %}
<h1 class="page-title">ğŸ¨ ÙƒÙ„ Ø§Ù„ØªØµØ§Ù…ÙŠÙ…</h1>

<div class="filter-container">
    <a href="?" class="filter-btn active">âœ¨ Ø§Ù„ÙƒÙ„</a>
    <a href="?type=button" class="filter-btn">ğŸ”˜ Ø£Ø²Ø±Ø§Ø±</a>
    <a href="?type=card" class="filter-btn">ğŸƒ ÙƒØ±ÙˆØª</a>
    <a href="?type=navbar" class="filter-btn">ğŸ§­ Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„</a>
    <a href="?type=header" class="filter-btn">ğŸ“‘ Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø©</a>
    <a href="?type=form" class="filter-btn">ğŸ“ Ù†Ù…ÙˆØ°Ø¬</a>

    <!----New filter for loaders  !!!!!!!   Ø¶ÙŠÙÙ‡ ÙØ§Ù„Ø¨Ø§Ùƒ!   !!!!!!!!!!!--->
    <a href="?type=loader" class="filter-btn">âŒ› ØªØ­Ù…ÙŠÙ„</a>
</div>

<!-- Design Grid -->
<div class="design-grid">
    {% for design in designs %}
        <div class="design-card">
            <div class="card-content">
                <h2 class="design-title">{{ design.name }}</h2>
                
                <div class="design-type">
                    <span>ğŸ·ï¸</span>
                    <span>{{ design.get_design_type_display }}</span>
                </div>
                
                <p class="design-description">{{ design.description|default:"Ø¨Ø¯ÙˆÙ† ÙˆØµÙ Ù…ØªØ§Ø­ Ù„Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ…ÙŠÙ…" }}</p>
                
                <!-- Live Preview -->
                <div class="preview-box">
                    <iframe
                        id="preview-iframe-{{ design.id }}"
                        class="preview-iframe"
                        onload="
                            const iframe = this;
                            const doc = iframe.contentWindow.document;
                            doc.open();
                            doc.write(`<!DOCTYPE html>
                            <html>
                            <head>
                                <style>
                                    body { margin: 0; padding: 1rem; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
                                    {{ design.css_code|escapejs }}
                                </style>
                            </head>
                            <body>
                                {{ design.html_code|escapejs }}
                            </body>
                            </html>`);
                            doc.close();
                        ">
                    </iframe>
                </div>
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® -->
        <div class="copy-buttons">
          <button class="btn-copy" onclick="copyToClipboard(`{{ design.html_code|escapejs }}`)">ğŸ“‹ Ù†Ø³Ø® HTML</button>
          <button class="btn-copy" onclick="copyToClipboard(`{{ design.css_code|escapejs }}`)">ğŸ“‹ Ù†Ø³Ø® CSS</button>
        </div>
      </div>
{% if request.user == design.creator %}
  <a href="{% url 'edit_design' design.pk %}" class="btn-primary mt-2 inline-block">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØµÙ…ÙŠÙ…</a>
{% endif %}

      <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµÙ…Ù… -->
      <div class="text-sm text-gray-600 mt-auto">
        ğŸ‘¤ Ø¨ÙˆØ§Ø³Ø·Ø©:
        <a href="{% url 'designer_profile' design.creator.username %}" class="text-blue-500 hover:underline">
          {{ design.creator.username }}
        </a><br>
        ğŸ•’ Ø¨ØªØ§Ø±ÙŠØ®: {{ design.created_at|date:"Y-m-d H:i" }}
      </div>
    </div>
  {% empty %}
    <p class="text-center text-gray-500 col-span-3">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØµØ§Ù…ÙŠÙ… Ø¨Ø¹Ø¯.</p>
  {% endfor %}
  
</div>
{% endblock %}
